{% load static %}
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="utf-8"/>
    <title>ArtFlow - {{ room_name }} Waiting Room</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Poppins:wght@600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/room.css' %}">
    <link rel="stylesheet" href="{% static 'css/waiting_room.css' %}">
    <link rel="stylesheet" href="{% static 'css/decorations.css' %}">
    <script src="{% static 'js/waiting_room.js' %}"></script>
</head>
<body class="room-page waiting-room-page">
    <!-- 背景裝飾 -->
    <div class="background-shape shape-1"></div>
    <div class="background-shape shape-2"></div>
    <div class="background-shape shape-3"></div>
    
    <!-- 新增裝飾元素 -->
    <div class="decorative-elements">
        <div class="decorative-shape dec-circle large"></div>
        <div class="decorative-shape dec-triangle small"></div>
        <div class="decorative-shape dec-square large"></div>
        <div class="decorative-shape dec-zigzag small"></div>
    </div>
    
    <!-- 導航欄 -->
    <nav class="navbar">
        <div class="logo">Art<span>Flow</span></div>
        <div class="room-info">{{ room_name }}</div>
        <div class="nav-actions">
            <button onclick="window.location.href='/'" class="btn-home">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="nav-icon">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                    <polyline points="9 22 9 12 15 12 15 22"></polyline>
                </svg>
                <span>大廳</span>
            </button>
        </div>
    </nav>
    
    <!-- 添加數據屬性來存儲 Django 模板變數 -->
    <div id="room-data" 
        data-room-name="{{ room_name }}" 
        data-csrf-token="{{ csrf_token }}" 
        style="display: none;">
    </div>
    
    <div class="container waiting-container">
        <div class="room-header">
            <div class="header-content">
                <div class="header-icon">
                    <svg viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2">
                        <path d="M23 12C23 18.0751 18.0751 23 12 23C5.92487 23 1 18.0751 1 12C1 5.92487 5.92487 1 12 1C18.0751 1 23 5.92487 23 12ZM3.00683 12C3.00683 16.9668 7.03321 20.9932 12 20.9932C16.9668 20.9932 20.9932 16.9668 20.9932 12C20.9932 7.03321 16.9668 3.00683 12 3.00683C7.03321 3.00683 3.00683 7.03321 3.00683 12Z"></path>
                        <path d="M12 5C11.4477 5 11 5.44771 11 6V12.4667C11 12.4667 11 12.7274 11.1267 12.9235C11.2115 13.0898 11.3437 13.2343 11.5174 13.3346L16.1372 16.0019C16.6155 16.278 17.2271 16.1141 17.5032 15.6358C17.7793 15.1575 17.6155 14.5459 17.1372 14.2698L13 11.8812V6C13 5.44772 12.5523 5 12 5Z"></path>
                    </svg>
                </div>
                <div class="header-text">
                    <h1>等待其他玩家加入</h1>
                    <p class="room-description">分享以下連結給好友一起同樂，或添加機器人玩家！</p>
                </div>
            </div>
            <div class="action-container">
                <button id="help-button" class="help-button" title="查看遊戲說明">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M12 2.75C6.89137 2.75 2.75 6.89137 2.75 12C2.75 17.1086 6.89137 21.25 12 21.25C17.1086 21.25 21.25 17.1086 21.25 12C21.25 6.89137 17.1086 2.75 12 2.75ZM1.25 12C1.25 6.06294 6.06294 1.25 12 1.25C17.9371 1.25 22.75 6.06294 22.75 12C22.75 17.9371 17.9371 22.75 12 22.75C6.06294 22.75 1.25 17.9371 1.25 12ZM12 7.75C11.3787 7.75 10.875 8.25368 10.875 8.875C10.875 9.28921 10.5392 9.625 10.125 9.625C9.71079 9.625 9.375 9.28921 9.375 8.875C9.375 7.42525 10.5503 6.25 12 6.25C13.4497 6.25 14.625 7.42525 14.625 8.875C14.625 9.83834 14.1056 10.6796 13.3353 11.1354C13.1385 11.2518 12.9761 11.3789 12.8703 11.5036C12.7675 11.6246 12.75 11.7036 12.75 11.75V13C12.75 13.4142 12.4142 13.75 12 13.75C11.5858 13.75 11.25 13.4142 11.25 13V11.75C11.25 11.2441 11.4715 10.8336 11.7266 10.533C11.9786 10.236 12.2929 10.0092 12.5715 9.84439C12.9044 9.64739 13.125 9.28655 13.125 8.875C13.125 8.25368 12.6213 7.75 12 7.75ZM12 17C12.5523 17 13 16.5523 13 16C13 15.4477 12.5523 15 12 15C11.4477 15 11 15.4477 11 16C11 16.5523 11.4477 17 12 17Z"></path>
                    </svg>
                    <span>遊戲說明</span>
                </button>
                <div class="share-link">
                    <input type="text" id="room-link" readonly value="{{ request.build_absolute_uri }}" class="form-input">
                    <!-- <input type="text" id="room-link" readonly value="{{ request.build_absolute_uri|urlencode }}" class="form-input"> -->
                    <button id="copy-link" class="btn-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <div class="waiting-content">
            <!-- 左側：玩家列表和操作 -->
            <div class="player-section">
                <div class="card player-card">
                    <h3>玩家列表</h3>
                    <div class="player-count">
                        <span id="player-count-display">1</span>/8 位玩家
                    </div>

                    <div class="player-list-container">
                        <ul id="player-list" class="player-list">
                            <!-- JavaScript 會填充玩家列表 -->
                        </ul>
                    </div>
                    
                    <div class="waiting-actions">
                        <button id="add-bot" class="btn btn-secondary">
                            添加機器人
                        </button>
                        <button id="remove-bot" class="btn btn-danger" disabled>
                            移除機器人
                        </button>
                    </div>
                    
                    <button id="start-game-button" class="btn btn-start" disabled>
                        開始遊戲
                    </button>
                </div>
            </div>
            
            <!-- 右側：聊天室 -->
            <div class="card chat-card">
                <h3>聊天室</h3>
                <div id="chat-log" class="chat-log"></div>
                <div id="chat-controls" class="chat-controls">
                    <input id="chat-message-input" type="text" placeholder="輸入訊息..." class="form-input">
                </div>
            </div>
        </div>
    </div>

    <!-- 遊戲說明模態視窗 -->
    <div id="instructions-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>遊戲說明</h2>
                <button id="close-modal" class="close-button">&times;</button>
            </div>
            <div class="modal-body">
                <div class="game-instructions">
                    <div class="instruction-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4>出題階段</h4>
                            <p>每位玩家提出一個有趣的題目或場景描述</p>
                        </div>
                    </div>
                    <div class="instruction-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>繪畫階段</h4>
                            <p>玩家需根據分配到的題目進行創意繪畫</p>
                        </div>
                    </div>
                    <div class="instruction-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4>猜測階段</h4>
                            <p>猜測其他玩家繪畫的原始題目是什麼</p>
                        </div>
                    </div>
                    <div class="instruction-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h4>結果展示</h4>
                            <p>查看所有玩家的題目、繪畫和猜測，一起歡笑！</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 彈出通知 -->
    <div id="notification" class="notification hidden">
        <svg class="notification-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
            <polyline points="22 4 12 14.01 9 11.01"></polyline>
        </svg>
        <span id="notification-text">連結已複製!</span>
    </div>
</body>
</html>
